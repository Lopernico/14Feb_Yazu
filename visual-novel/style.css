:root{--bg:#2b0a12;--accent:#ff6b9a;--accent-2:#c86bff;--panel:rgba(255,255,255,0.06);--glass:rgba(255,255,255,0.03)}*{box-sizing:border-box}html,body,#app{height:100%}body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:radial-gradient(circle at 10% 10%, rgba(255,105,135,0.12), transparent 18%), linear-gradient(180deg,#3a0720 0%,#170014 100%);color:#fff3fb;display:flex;align-items:stretch;min-height:100vh;overflow:hidden} 
.app{display:grid;grid-template-columns:1fr;gap:0;padding:0;width:100vw;height:100vh;max-width:none;margin:0;align-items:stretch;overflow:hidden} 
.vn{background:linear-gradient(180deg, rgba(255,105,135,0.03), rgba(24,6,18,0.06));border-radius:0;overflow:hidden;display:flex;flex-direction:column;height:100vh;border:none;box-shadow:none;position:relative;z-index:0}
.vn > *{position:relative;z-index:1} 
.scene{flex:1;position:relative;background:transparent;display:flex;align-items:center;justify-content:center;padding-bottom:10vh;min-height:60vh} 
/* ----- Title screen (initial sequence) ----- */
.title-screen{
  position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  background:linear-gradient(180deg,rgba(8,2,6,0.35),rgba(16,4,12,0.65));
  z-index:50;cursor:pointer;text-align:center;padding:6vh 5vw;backdrop-filter: blur(4px);
  overflow:hidden;
}

/* animated background particles */
.particles{
  position:absolute;inset:0;pointer-events:none;
  background-image: 
    radial-gradient(circle at 20% 50%, rgba(255,107,154,0.08) 0, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(200,120,220,0.08) 0, transparent 50%),
    radial-gradient(circle at 50% 0%, rgba(255,150,200,0.06) 0, transparent 50%);
  background-size: 200% 200%;
  animation: bgShift 8s ease-in-out infinite;
  z-index:0;
}
@keyframes bgShift{
  0%{background-position:0% 0%, 100% 100%, 50% 0%} 
  50%{background-position:100% 100%, 0% 0%, 50% 100%}
  100%{background-position:0% 0%, 100% 100%, 50% 0%}
}

/* floating emojis */
.floating-emojis{position:absolute;inset:0;pointer-events:none;z-index:0;overflow:hidden;}
.emoji{
  position:absolute;font-size:clamp(24px,4vw,48px);opacity:0.6;animation:floatEmoji 8s ease-in-out infinite;
  filter:drop-shadow(0 4px 12px rgba(255,107,154,0.2));
}
.emoji.e1{left:5%;top:15%;animation-delay:0s;animation-duration:6.5s}
.emoji.e2{left:92%;top:8%;animation-delay:1.2s;animation-duration:7s}
.emoji.e3{left:10%;top:75%;animation-delay:0.4s;animation-duration:8.2s}
.emoji.e4{left:85%;top:70%;animation-delay:2s;animation-duration:7.8s}
.emoji.e5{left:50%;top:10%;animation-delay:0.8s;animation-duration:9s}
.emoji.e6{left:15%;top:45%;animation-delay:1.6s;animation-duration:6.8s}
.emoji.e7{left:88%;top:35%;animation-delay:0.2s;animation-duration:8.5s}
.emoji.e8{left:25%;top:82%;animation-delay:1.4s;animation-duration:7.2s}
.emoji.e9{left:75%;top:12%;animation-delay:0.6s;animation-duration:8.8s}
.emoji.e10{left:40%;top:85%;animation-delay:2.2s;animation-duration:7.5s}
.emoji.e11{left:5%;top:50%;animation-delay:0.9s;animation-duration:9.2s}
.emoji.e12{left:95%;top:55%;animation-delay:1.8s;animation-duration:6.9s}

@keyframes floatEmoji{
  0%{transform:translateY(0) scale(1) rotate(0deg)}
  25%{transform:translateY(-40px) scale(1.1) rotate(8deg)}
  50%{transform:translateY(-80px) scale(0.95) rotate(-4deg)}
  75%{transform:translateY(-40px) scale(1.05) rotate(6deg)}
  100%{transform:translateY(0) scale(1) rotate(0deg)}
}

.title-content{
  color:#ffeef6;max-width:1100px;margin:auto;position:relative;z-index:10;
  animation: vnTitleIn 1.2s cubic-bezier(.19,.85,.19,1) forwards, sway 2.5s ease-in-out 1.2s infinite;
  text-shadow:0 8px 32px rgba(0,0,0,0.4);
}

.title-line1{
  font-size:clamp(18px,2.6vw,28px);margin:0;color:#ffdce8;font-weight:700;
  letter-spacing:1px;text-transform:lowercase;opacity:1;
  animation:popIn 0.8s cubic-bezier(.19,.85,.19,1) both;
  text-shadow:0 4px 16px rgba(255,107,154,0.2);
}

.title-line2{
  font-size:clamp(28px,6.8vw,64px);margin:12px 0 0;display:flex;align-items:baseline;
  justify-content:center;gap:.6rem;flex-wrap:wrap;
}

.title-line2 .amor{
  font-size:.45em;color:#ffdfe6;transform:translateY(8px);opacity:0.9;
  animation:fadeInSmall 0.9s cubic-bezier(.19,.85,.19,1) 0.2s both;
}

.title-line2 .amistad{
  font-size:1.6em;color:var(--accent-2);font-weight:900;letter-spacing:-1px;
  animation:popPulse 1.2s cubic-bezier(.19,.85,.19,1) 0.4s both;
  text-shadow:0 8px 24px rgba(200,80,150,0.3), 0 2px 8px rgba(200,80,150,0.2);
  filter:drop-shadow(0 4px 12px rgba(200,80,150,0.25));
}

.dedication{
  margin-top:18px;font-size:clamp(12px,1.6vw,16px);color:#ffdfe8;opacity:0.95;
  animation:fadeInUp 1s cubic-bezier(.19,.85,.19,1) 0.6s both;
}

.quote{
  margin-top:10px;font-size:clamp(14px,1.6vw,18px);color:#ffebf3;font-style:italic;opacity:0.95;
  animation:fadeInUp 1s cubic-bezier(.19,.85,.19,1) 0.8s both;
}

.start-hint{
  margin-top:24px;padding:12px 22px;border-radius:999px;
  background:linear-gradient(90deg,rgba(255,107,154,0.18),rgba(200,80,150,0.12));
  color:#ffdfe8;font-weight:800;display:inline-block;
  animation:fadeInUp 1s cubic-bezier(.19,.85,.19,1) 1s both, pulse 2s ease-in-out 1.6s infinite;
  border:1px solid rgba(255,150,200,0.3);
  box-shadow:0 8px 24px rgba(255,107,154,0.15);
}

@keyframes sway{
  0%, 100%{transform:translateY(0) scale(1)}
  50%{transform:translateY(-8px) scale(1.01)}
}
@keyframes vnTitleIn{from{opacity:0;transform:translateY(12px) scale(.94)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes popIn{from{opacity:0;transform:translateY(-20px) scale(.92)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes fadeInSmall{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}
@keyframes popPulse{from{opacity:0;transform:scale(.7) translateY(10px)}to{opacity:1;transform:scale(1) translateY(0)}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{
  0%{transform:scale(1);box-shadow:0 8px 24px rgba(255,107,154,0.15)}
  50%{transform:scale(1.05);box-shadow:0 12px 32px rgba(255,107,154,0.25)}
  100%{transform:scale(1);box-shadow:0 8px 24px rgba(255,107,154,0.15)}
}

/* utility */
.hidden{display:none !important}
.sprite{width:min(62vw,980px);max-height:72vh;height:auto;transition:transform .35s ease,opacity .2s ease;transform-origin:center bottom;filter:drop-shadow(0 30px 50px rgba(0,0,0,0.55));opacity:1}
.hearts{position:absolute;inset:0;pointer-events:none;width:100%;height:100%;overflow:hidden;opacity:0.95;z-index:-1}
.hearts-scroll{position:absolute;inset:0;width:100%;height:100%;overflow:hidden}
.hearts-scroll::before{content:'';position:absolute;inset:0;background-color:rgba(105, 25, 75, 0.288);pointer-events:none;z-index:1}
.hearts-track{display:flex;flex-direction:column;width:100%;height:100%;gap:0;padding:0;margin:0}
.heart-row{display:flex;white-space:nowrap;width:fit-content;animation:horizontalScroll 36s linear infinite;gap:0}
.hearts-track span{display:inline-block;font-size:clamp(96px,15vw,156px);opacity:0.85;filter:drop-shadow(0 2px 8px rgba(255,107,154,0.15));line-height:1;margin:0}
@keyframes horizontalScroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}

/* Final banner styles */
.final-banner{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(71, 25, 50, 0.562),rgba(255,220,235,0.03));z-index:220;padding:6vh 5vw}
.final-banner .final-particles{position:absolute;inset:0;background-image:radial-gradient(circle at 20% 50%, rgba(255,107,154,0.06) 0, transparent 40%), radial-gradient(circle at 80% 80%, rgba(200,120,220,0.05) 0, transparent 40%);background-size:200% 200%;animation:bgShift 9s ease-in-out infinite;opacity:0.9}
.final-banner .final-hearts{position:absolute;inset:0;pointer-events:none;width:100%;height:100%;overflow:hidden;opacity:0.95;z-index:-1}
.final-banner .final-hearts .hearts-scroll{position:absolute;inset:0;width:100%;height:100%;overflow:hidden}
.final-banner .final-hearts .hearts-scroll::before{content:'';position:absolute;inset:0;background-color:rgba(44, 8, 44, 0.753);pointer-events:none;z-index:1}
.final-banner .final-hearts .hearts-track{display:flex;flex-direction:column;width:100%;height:100%;gap:0;padding:0;margin:0}
.final-banner .final-hearts .heart-row{display:flex;white-space:nowrap;width:fit-content;animation:horizontalScroll 32s linear infinite;gap:0}
.final-banner .final-hearts .hearts-track span{display:inline-block;font-size:clamp(108px,18vw,180px);opacity:0.9;filter:drop-shadow(0 3px 10px rgba(255,107,154,0.2));line-height:1;margin:0}
.final-content{position:relative;z-index:10;padding:36px 48px;border-radius:20px;background:linear-gradient(180deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,0.04);box-shadow:0 30px 80px rgba(200,40,100,0.15);text-align:center;max-width:920px}
.final-text{color:#3a0011}
.final-main{display:block;margin:0 auto;max-width:880px}

/* title (YAZUMIMOON) in purple with per-letter pop */
.final-title{margin-bottom:14px}
.final-name{display:inline-block;font-family:serif;font-weight:900;color:var(--accent-2);font-size:clamp(36px,8.6vw,96px);letter-spacing:2px;text-transform:uppercase;animation:finalNamePulse 1.2s ease-in-out both;filter:drop-shadow(0 12px 30px rgba(120,40,140,0.28))}
.final-name span{display:inline-block;transform-origin:center bottom;animation:letterPop .8s cubic-bezier(.19,.85,.19,1) both}
@keyframes finalNamePulse{0%{transform:translateY(8px) scale(.96);opacity:0}30%{transform:translateY(-8px) scale(1.04);opacity:1}100%{transform:translateY(0) scale(1);opacity:1}}
@keyframes letterPop{0%{transform:translateY(18px) scale(.86);opacity:0}60%{transform:translateY(-8px) scale(1.08);opacity:1}100%{transform:translateY(0) scale(1);opacity:1}}

/* final-date */
.final-date{font-size:clamp(14px,2.2vw,22px);color:#ff8ab0;margin-top:6px;opacity:0.95;animation:dateFloat 3s ease-in-out infinite}
@keyframes dateFloat{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}

/* final-thanks: word-by-word pop */
.final-thanks{font-size:clamp(18px,3.8vw,40px);color:#fd80c1;font-weight:900;line-height:1.02;margin-top:6px;text-align:center;word-break:break-word}
.final-thanks .thanks-word{display:inline-block;opacity:0;transform:translateY(12px);animation:thanksWord .7s cubic-bezier(.2,.85,.2,1) forwards}
@keyframes thanksWord{0%{transform:translateY(18px) scale(.98);opacity:0}60%{transform:translateY(-6px) scale(1.04);opacity:1}100%{transform:translateY(0) scale(1);opacity:1}}

/* subtle subtitle style */
.final-sub{margin-top:12px;font-size:14px;color:#ffffff;font-style:italic;opacity:0.95}

/* confetti + hearts burst (used dynamically when banner appears) */
.confetti-piece, .burst-heart{position:absolute;left:50%;top:35%;transform:translate(-50%,-50%);pointer-events:none;z-index:30}
.confetti-piece{width:10px;height:14px;border-radius:2px;mix-blend-mode:screen;animation:confettiBurst var(--d,1200ms) cubic-bezier(.2,.8,.2,1) forwards}
.burst-heart{font-size:20px;animation:heartBurst var(--d,1200ms) cubic-bezier(.2,.8,.2,1) forwards}
@keyframes confettiBurst{0%{opacity:1;transform:translate(-50%,-50%) scale(1)}
40%{opacity:1}
100%{opacity:0;transform:translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) rotate(var(--rot)) scale(.9)} }
@keyframes heartBurst{0%{opacity:1;transform:translate(-50%,-50%) scale(.8)}
60%{opacity:1}
100%{opacity:0;transform:translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) rotate(var(--rot)) scale(1.1)} }
.final-actions{margin-top:18px}
.final-actions .btn{padding:10px 18px;border-radius:999px;background:linear-gradient(90deg,#ff8ab0,#c86bff);color:#fff;border:none;cursor:pointer;box-shadow:0 12px 40px rgba(200,80,150,0.18)}
@keyframes finalPop{from{opacity:0;transform:translateY(12px) scale(.96)}to{opacity:1;transform:translateY(0) scale(1)}} 
.dialogue{position:absolute;left:50%;transform:translateX(-50%);bottom:28px;width:min(94%,1100px);padding:22px 26px;border-radius:18px;background:linear-gradient(180deg,rgba(18,4,14,0.65),rgba(22,4,14,0.82));backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,0.04);box-shadow:0 20px 60px rgba(40,6,30,0.45)} 
.dialogue .meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.name{font-weight:700;color:var(--accent);font-size:14px}
.name::before{content:"‚ù§";margin-right:8px;color:var(--accent-2);opacity:.95}
.text{font-size:clamp(16px,2.2vw,20px);line-height:1.6;min-height:96px;color:#fff6fb} 
.controls button{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;color:#310018;padding:8px 12px;border-radius:12px;cursor:pointer;font-weight:700;box-shadow:0 10px 30px rgba(200,80,150,0.12);margin-left:8px} 
.controls button:disabled{opacity:.3;cursor:default}
.choices{margin-top:12px;display:flex;flex-wrap:wrap;gap:8px}
.choices button{background:linear-gradient(180deg,var(--accent-2),var(--accent));border:1px solid rgba(255,255,255,0.06);padding:14px 20px;border-radius:14px;color:#3b0217;cursor:pointer;box-shadow:0 10px 28px rgba(255,107,154,0.14);transition:transform .16s ease,filter .16s ease;font-size:clamp(14px,1.6vw,18px)}
.choices button:hover{transform:translateY(-6px);filter:brightness(1.05)} 
.choices button:hover{transform:translateY(-4px);filter:brightness(1.03)}
.editor{background:var(--glass);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);max-height:720px;overflow:auto}
.editor h2{margin:4px 0 8px;font-size:18px}
#scriptEditor{width:100%;height:300px;background:rgba(10,14,20,0.6);color:#dbeafe;border-radius:8px;border:1px solid rgba(255,255,255,0.02);padding:12px;font-family:ui-monospace,SFMono-Regular,Menlo,monospace;font-size:13px;resize:vertical}
.editor-controls{margin-top:8px;display:flex;gap:8px}
.editor-controls button{background:var(--accent);border:none;color:#022;padding:8px 10px;border-radius:8px;cursor:pointer}
.schema{background:transparent;color:#9fb7d9;padding:8px;border-radius:6px;margin-top:10px;overflow:auto}
.note{font-size:13px;color:#9fb7d9;margin-top:8px}
@media(max-width:980px){.app{grid-template-columns:1fr}.editor{order:2}.vn{order:1}}

/* audio controls */
.audio-controls{position:fixed;right:18px;top:18px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.02));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);backdrop-filter:blur(6px);z-index:120;color:#fff}
.audio-controls label{display:block;font-size:13px;margin:6px 0}
.audio-controls input[type=file]{display:inline-block}
.audio-controls .vols{display:flex;gap:10px;margin-top:8px}
.audio-controls input[type=range]{width:120px}

/* end screen */
.end-screen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.75);z-index:200}
.end-content{text-align:center;color:#fbe7e7}
.end-title{font-size:clamp(36px,8vw,120px);color:#9b0000;text-shadow:0 20px 40px rgba(0,0,0,0.8),0 2px 8px rgba(255,80,80,0.15);font-family:serif;letter-spacing:6px;transform:skewX(-6deg)}
.end-buttons{margin-top:20px;display:flex;gap:12px;justify-content:center}
.end-buttons .btn{padding:10px 18px;border-radius:10px;background:linear-gradient(180deg,#2b0010,#4b0016);color:#ffdfe8;border:1px solid rgba(255,80,80,0.15);cursor:pointer;box-shadow:0 6px 22px rgba(0,0,0,0.6)}
.vn.dimmed{filter:grayscale(.2) brightness(.35) blur(2px)}
